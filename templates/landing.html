<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Krishna Janmashtami 2025 - Welcome</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
        }
        
        .landing-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .landing-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 2;
        }
        
        .skip-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .skip-button:hover {
            background: rgba(255,255,255,0.3);
            color: white;
            text-decoration: none;
        }
        
        /* Smooth transition animation */
        .landing-container {
            transition: opacity 1s ease-in-out;
        }
        
        .landing-container.fade-out {
            opacity: 0;
        }
        

    </style>
</head>
<body>
    <div class="landing-container">
        <div class="video-container">
            <video class="landing-video" autoplay muted playsinline preload="auto" id="landingVideo">
                <source src="{{ url_for('static', filename='images/ganppa.mp4') }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            
            <div class="video-overlay"></div>
        </div>
        
        <a href="{{ url_for('home') }}" class="skip-button">
            <i class="fas fa-forward"></i> Skip
        </a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('landingVideo');
            const skipButton = document.querySelector('.skip-button');
            let redirectTimeout;
            let hasRedirected = false;
            
            // Function to smoothly transition to main website
            function smoothTransition() {
                if (hasRedirected) return; // Prevent multiple redirects
                hasRedirected = true;
                
                const container = document.querySelector('.landing-container');
                container.classList.add('fade-out');
                
                setTimeout(function() {
                    window.location.href = "{{ url_for('home') }}";
                }, 1000); // Wait for fade animation to complete
            }
            
            // Handle video load errors
            video.addEventListener('error', function() {
                console.log('Video failed to load, redirecting...');
                smoothTransition();
            });
            
            // Auto redirect when video ends
            video.addEventListener('ended', function() {
                console.log('Video ended, redirecting...');
                smoothTransition();
            });
            
            // Handle video can play event
            video.addEventListener('canplay', function() {
                console.log('Video can play');
                // Start playing if not already playing
                if (video.paused) {
                    video.play().catch(function(error) {
                        console.log('Video play failed:', error);
                        smoothTransition();
                    });
                }
            });
            
            // Fallback redirect after video duration (or 10 seconds minimum)
            video.addEventListener('loadedmetadata', function() {
                console.log('Video metadata loaded, duration:', video.duration);
                const videoDuration = video.duration * 1000; // Convert to milliseconds
                const minDuration = 10000; // 10 seconds minimum
                const redirectTime = Math.max(videoDuration, minDuration);
                
                redirectTimeout = setTimeout(function() {
                    console.log('Fallback timeout reached, redirecting...');
                    smoothTransition();
                }, redirectTime);
            });
            
            // Skip button functionality
            skipButton.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Skip button clicked');
                if (redirectTimeout) clearTimeout(redirectTimeout);
                smoothTransition();
            });
            
            // Fallback redirect if video doesn't load within 5 seconds
            setTimeout(function() {
                if (video.readyState === 0) {
                    console.log('Video not loaded within 5 seconds, redirecting...');
                    smoothTransition();
                }
            }, 5000); // 5 seconds fallback
            
            // Additional fallback after 15 seconds
            setTimeout(function() {
                if (!hasRedirected) {
                    console.log('15-second fallback reached, redirecting...');
                    smoothTransition();
                }
            }, 20000);
        });
    </script>
</body>
</html>
